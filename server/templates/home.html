<!DOCTYPE html>
<html lang="en">
<!-- Based off of example: https://raw.githubusercontent.com/23/resumable.js/master/samples/Node.js/public/index.html -->

<head>
    <meta charset="UTF-8">
    <title>DCC Large File Upload</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header><h1>Upload files to the DCC</h1></header>
    <div class="container-fluid">

        <!-- Transfer code and login -->
        <div class="row col-sm-10 col-sm-offset-1 transfer-code">
            <div class="resumable-error">
                Oh no! Your browser isn't supported. Please try a recent version of Chrome or Firefox.
            </div>
            <form class="form-horizontal auth-token-form col-sm-10">
                <div class="form-group">
                    <label for="auth-token" class="control-label">Transfer code</label>
                    <div class="input-group">
                        <input id="auth-token" type="text" name="authToken" class="form-control"
                               placeholder="Please enter your transfer code">
                            <span class="btn btn-primary input-group-addon login auth-success">
                                <span class="glyphicon glyphicon-log-in transfer-symbol"></span> Login
                            </span>
                    </div>
                </div>
            </form>
            <div class="logout col-sm-2">
                    <button class="btn btn-primary pull-right logout-button">
                            <span class="glyphicon glyphicon-log-out"></span> Logout
                    </button>
            </div>
        </div>

        <!-- Table showing selected sample files -->
        <div class="row col-sm-10 col-sm-offset-1 sample-table">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <span class="glyphicon glyphicon-triangle-right pull-left" aria-hidden="true"></span>Select
                    Samples for Upload
                </div>
                <div class="panel-body collapsed">
                    <p>
                        To start uploading your files hit the <em>Add Sample</em> button. You will be required to
                        provide a sample name and specify all applicable metadata for the sample you wish to upload.
                        You may also alter sample and individual metadata options after attaching your files. Sample
                        name, readset, and library must be composed solely of letters, numbers, hyphens, and/or
                        underscores to ensure compatibility with downstream pipelines.
                    </p>
                    <div data-toggle="tooltip" title="Add a new sample">
                        <button class="btn btn-primary pull-right modal-add-sample-button"
                                data-toggle="modal"
                                data-target="#add-sample-modal">
                            <span class="glyphicon glyphicon-plus"></span>
                            Add Sample
                        </button>
                    </div>
                </div>
                <table class="table table-condensed table-data collapsed">
                    <thead>
                    <tr class="active">
                        <th></th>
                        <th colspan="2">Files</th>
                        <th>File Type</th>
                        <th>Readset</th>
                        <th>Platform</th>
                        <th>Run Type</th>
                        <th>Capture Kit</th>
                        <th>Library</th>
                        <th>Reference</th>
                        <th class="upload-status">Status</th>
                        <th class="options">Options</th>
                    </tr>
                    </thead>
                    <tbody class="sample-template">
                    <tr class="active sample-header-template">
                        <td><span class="sample-collapse glyphicon glyphicon-triangle-bottom"></span></td>
                        <td class="sample-name sample-collapse"></td>
                        <td class="sample-collapse" colspan="8"></td>
                        <td class="sample-option">
                             <span class="option-icon edit-sample glyphicon glyphicon-pencil"
                                   data-toggle="modal"
                                   data-target="#edit-sample-modal"
                                   title="Edit metadata for entire sample"></span>
                            <span class="option-icon resumable-add add-files glyphicon glyphicon-plus"
                                  data-toggle="tooltip"
                                  title="Add file(s) to sample"></span>
                            <span class="option-icon remove-sample glyphicon glyphicon-remove" data-toggle="tooltip"
                                  title="Remove sample"></span>
                        </td>
                    </tr>
                    <tr class="sample-file-template">
                        <td class="file-icon"><span class="glyphicon glyphicon-file pull-right"></span></td>
                        <td class="file-name" colspan="2"></td>
                        <td class="file-type"></td>
                        <td class="file-readset"></td>
                        <td class="file-platform"></td>
                        <td class="file-run-type"></td>
                        <td class="file-capture-kit"></td>
                        <td class="file-library"></td>
                        <td class="file-reference"></td>
                        <td class="progress">
                            <div class="progress-bar progress-bar-striped active" role="progressbar"></div>
                        </td>
                        <td class="option">
                            <span class="option-icon edit-file glyphicon glyphicon-pencil"
                                  data-toggle="modal"
                                  data-target="#edit-file-modal"
                                  title="Edit file metadata"></span>
                            <span class="option-icon remove-file glyphicon glyphicon-remove" data-toggle="tooltip"
                                  title="Remove file"></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <div class="panel-footer collapsed">
                    <button type="button" class="btn btn-primary col-xs-2 pull-right upload-sample-button disabled"
                            data-toggle="tooltip" title="Upload all files to the DCC">
                        <span class="glyphicon glyphicon-cloud-upload" aria-hidden="true"></span> Upload All
                    </button>
                    <button type="button" class="btn btn-primary pull-right resume-upload"
                            data-toggle="tooltip" title="Resume upload of all files">
                        <span class="glyphicon glyphicon-cloud-upload" aria-hidden="true"></span> Resume All</button>
                    <button type="button" class="btn btn-primary pull-right pause-upload"
                            data-toggle="tooltip" title="Pause upload of all files">
                        <span class="glyphicon glyphicon-pause" aria-hidden="true"></span> Pause All</button>
                    <button type="button" class="btn btn-default pull-right cancel-upload"
                            data-toggle="tooltip" title="Cancel upload of all files">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Add sample modal -->
        <div id="add-sample-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Sample Metadata</h4>
                    </div>
                    <div class="modal-body">
                        <form class="form-horizontal modal-sample-form">
                            <p>
                                Please specify all applicable metadata for the sample you wish to upload. You may
                                also alter sample and individual metadata options after attaching your files. Files
                                already added to the queue cannot be added again. A sample name is required and, along
                                with the readset and library, must be composed solely of letters, numbers, hyphens,
                                and/or underscores.
                            </p>
                            <div class="form-group has-error">
                                <label for="sampleName" class="col-sm-3 control-label">Sample Name</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="sampleName" placeholder="Sample name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Platform</label>
                                <div class="col-sm-9">
                                    <input class="typeahead" id="add-platform" type="text" placeholder="Sequencing platform">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Run Type</label>
                                <div class="col-sm-9">
                                    <select class="form-control" id="add-run-type">
                                        <option>Single End</option>
                                        <option>Paired End</option>
                                        <option selected>N/A</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Capture Kit</label>
                                <div class="col-sm-9">
                                    <input class="typeahead" id="add-capture-kit" type="text" placeholder="Capture kit name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Library Name</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="add-library" placeholder="Library name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Reference Genome</label>
                                <div class="col-sm-9">
                                    <input class="typeahead" id="add-reference" type="text" placeholder="Reference genome">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-11 col-sm-offset-1">
                                    <div class="resumable-modal-drop">
                                        <span>Drop files here or</span>
                                        <input type="button" class="resumable-browse btn btn-default" value="Browse your computer">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit sample modal -->
        <div id="edit-sample-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Edit Sample Metadata</h4>
                    </div>
                    <div class="modal-body">
                        <form class="form-horizontal modal-sample-form">
                            <p>
                                Check off <em>Edit All</em> to make changes across all the files included in this
                                sample. Readset and library must be composed solely of letters, numbers, hyphens,
                                and/or underscores. Sequencing metadata (except for readset) will not apply to file
                                types detected as <em>Other</em>. Individual file types can be changed along with
                                individual metadata by clicking the edit
                                 <span class="glyphicon glyphicon-pencil"></span> button at the end of the respective
                                file row.
                            </p>
                            <div class="form-group">
                                <label for="sampleName" class="col-sm-3 control-label">Sample Name</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="edit-sample-name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Readset</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control" id="edit-readset" placeholder="Readset name" disabled>
                                </div>
                                <label class="col-sm-2 edit-checkbox">
                                     <input type="checkbox" value="">
                                     Edit All
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Platform</label>
                                <div class="col-sm-7">
                                    <input class="typeahead form-control" id="edit-platform" type="text" placeholder="Sequencing platform" disabled>
                                </div>
                                <label class="col-sm-2 edit-checkbox">
                                     <input type="checkbox" value="">
                                     Edit All
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Run Type</label>
                                <div class="col-sm-7">
                                    <select class="form-control" id="edit-run-type" disabled>
                                        <option>Single End</option>
                                        <option>Paired End</option>
                                        <option selected>N/A</option>
                                    </select>
                                </div>
                                <label class="col-sm-2 edit-checkbox">
                                     <input type="checkbox" value="">
                                     Edit All
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Capture Kit</label>
                                <div class="col-sm-7">
                                    <input class="typeahead form-control" id="edit-capture-kit" type="text" placeholder="Capture kit name" disabled>
                                </div>
                                <label class="col-sm-2 edit-checkbox">
                                     <input type="checkbox" value="">
                                     Edit All
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Library Name</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control" id="edit-library" placeholder="Library name" disabled>
                                </div>
                                <label class="col-sm-2 edit-checkbox">
                                     <input type="checkbox" value="">
                                     Edit All
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Reference Genome</label>
                                <div class="col-sm-7">
                                    <input class="typeahead form-control" id="edit-reference" type="text" placeholder="Reference genome" disabled>
                                </div>
                                <label class="col-sm-2 edit-checkbox">
                                     <input type="checkbox" value="">
                                     Edit All
                                </label>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default cancel-edit-sample" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary save-edit-sample">Save changes</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit file modal -->
        <div id="edit-file-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Edit File Metadata</h4>
                    </div>
                    <div class="modal-body">
                        <form class="form-horizontal modal-sample-form">
                            <p>
                                Sequencing metadata options are only available for BAM/SAM, FASTQ, and VCF files. If you
                                would like to make changes across files in the whole sample, click the edit
                                 <span class="glyphicon glyphicon-pencil"></span> button at the end of the respective
                                sample header row. Readset and library must be composed solely of letters, numbers,
                                hyphens, and/or underscores.
                            </p>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">File Name</label>
                                <div class="col-sm-9"><p class="form-control-static file-name-title">Filename to go here</p></div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">File Type</label>
                                <div class="col-sm-9">
                                    <select class="form-control" id="edit-single-file-type">
                                        <option>FASTQ/FQ</option>
                                        <option>BAM/SAM</option>
                                        <option>VCF</option>
                                        <option>Other</option>
                                    </select>
                                </div>
                            </div>
                             <div class="form-group">
                                <label class="col-sm-3 control-label">Readset</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="edit-single-readset" placeholder="Readset name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Platform</label>
                                <div class="col-sm-9">
                                    <input class="typeahead form-control" id="edit-single-platform" type="text" placeholder="Sequencing platform">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Run Type</label>
                                <div class="col-sm-9">
                                    <select class="form-control" id="edit-single-run-type">
                                        <option>Single End</option>
                                        <option>Paired End</option>
                                        <option>N/A</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Capture Kit</label>
                                <div class="col-sm-9">
                                    <input class="typeahead form-control" id="edit-single-capture-kit" type="text" placeholder="Capture kit name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Library Name</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="edit-single-library" placeholder="Library name">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">Reference Genome</label>
                                <div class="col-sm-9">
                                    <input class="typeahead form-control" id="edit-single-reference" type="text" placeholder="Reference genome">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default cancel-edit-file" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary save-edit-file">Save changes</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Download complete modal -->
        <div id="upload-complete-modal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Upload Complete</h4>
                    </div>
                    <div class="modal-body">
                         <p>Upload completed, you may now logout or continue to uploading another sample.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default logout-button" data-dismiss="modal">
                            <span class="glyphicon glyphicon-log-out"></span> Logout</button>
                        <button type="button" class="btn btn-primary continue-session">Continue</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Table showing the files currently sitting on the DCC -->
        <div class="row col-sm-10 col-sm-offset-2 dcc-table">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <span class="glyphicon glyphicon-triangle-right pull-left" aria-hidden="true"></span>DCC
                </div>
                <div class="panel-body collapsed">
                    <p>
                        Instructions on how to request files that are currently sitting on the DCC. Files won't be available
                        for direct download immediately.
                    </p>
                </div>
                <table class="table table-condensed collapsed" id="dcc-table-data">
                    <thead>
                    <tr class="active">
                        <th>Sample Name</th>
                        <th>Files</th>
                        <th>Metadata</th>
                        <th>Status</th>
                        <th>Options</th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>

        <!-- Footer row -->
        <div class="row col-sm-8 col-sm-offset-1 footer-row">
            <div class="footer">
                If you have any questions or run into issues, please email Orion
                &lt;<a href="mailto:buske@cs.toronto.edu">buske@cs.toronto.edu</a>&gt;
                and/or Dorin
                &lt;<a href="mailto:dorin.manase@sickkids.ca">dorin.manase@sickkids.ca</a>&gt;.
            </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
            integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
            crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='resumable.js') }}"></script>
    <script src="{{ url_for('static', filename='typeahead.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='upload.js') }}"></script>
</body>
</html>
