<!DOCTYPE html>
<html lang="en">
<!-- Based off of example: https://raw.githubusercontent.com/23/resumable.js/master/samples/Node.js/public/index.html -->

<head>
    <meta charset="UTF-8">
    <title>DCC Large File Upload</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" dtype="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header><h1>Upload files to the Children's Stroke Program at The Hospital for Sick Children</h1></header>
    <div class="container-fluid">

        <!-- Transfer code and login -->
        <div class="row col-sm-10 col-sm-offset-1 transfer-code">
            <div class="resumable-error">
                Oh no! Your browser isn't supported. Please try a recent version of Chrome or Firefox.
            </div>
            <form class="form-horizontal auth-token-form col-sm-10">
                <div class="form-group">
                    <label for="auth-token" class="control-label">Transfer code</label>
                    <div class="input-group">
                        <div class="validated-input">
                            <input id="auth-token" type="text" name="authToken" class="form-control" autocomplete="off"
                                   placeholder="Please enter your transfer code">
                            <span class="transfer-code-invalid glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
                        </div>
                        <span class="input-group-btn">
                            <button class="btn btn-primary login auth-success">
                                <span class="glyphicon glyphicon-log-in transfer-symbol"></span> Login
                            </button>
                        </span>
                    </div>
                </div>
            </form>
            <div class="logout col-sm-2">
                    <button class="btn btn-default pull-right logout-button">
                            <span class="glyphicon glyphicon-log-out"></span> Logout
                    </button>
            </div>
        </div>

        <!-- Table showing selected sample files -->
        <div class="row col-sm-10 col-sm-offset-1 sample-table">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <span class="collapse-icon glyphicon glyphicon-triangle-bottom pull-left"></span>
                    <span class="collapse-icon glyphicon glyphicon-triangle-right pull-left" style="display: none;"></span>
                    Select Images for Upload
                </div>
                <div class="panel-body">
                    <p>
                        To start uploading your images hit the <em>Add Images</em> button below. You will be required to
                        provide the IPSS ID and the metadata of the patient whose images you wish to upload. <br><br>
                        In the event of persistent errors, try renaming the file and attempt to upload again, or contact the
                         <a href="mailto:stroke.research@sickkids.ca">Children's Stroke Program</a> for assistance</p>
                    <div data-toggle="tooltip" title="Add a new sample">
                        <button class="btn btn-primary pull-right modal-add-sample-button"
                                data-toggle="modal"
                                data-target="#add-sample-modal">
                            <span class="glyphicon glyphicon-plus"></span>
                            Add Images
                        </button>
                    </div>
                </div>

                <table class="table table-condensed table-data">
                        <thead>
                        <tr class="active">
                            <th class="files header col-sm-4 textAlignLeft paddingLeft20">Files</th>
                            <th class="study-type header col-sm-4">Study Type</th>
                            <th class="site-code header">Site Code</th>
                            <th class="time-point header">Time-Point</th>
                            <th class="progress header">Status</th>
                            <th class="option header textAlignRight paddingRight20">Options</th>
                        </tr>
                        </thead>
                        <!-- Sample List -->
                        <tbody class="sample-template sample-section">
                        <tr class="sample-header-row sample-header-template">
                            <td class="sample-collapse paddingLeft20 textAlignLeft">
                                <span class="sample-collapse-icon glyphicon glyphicon-folder-open"></span>
                                <span class="sample-collapse-icon glyphicon glyphicon-folder-close" style="display: none;"></span>
                                <a class="sample-name sample-name paddingLeft15"></a>
                            </td>
                            <td class="sample-collapse"></td>
                            <td class="sample-collapse"></td>
                            <td class="sample-collapse"></td>
                            <td class="sample-collapse sample-option">
                                <span class="option-icon resumable-add add-files glyphicon glyphicon-plus"
                                      data-toggle="modal"
                                      data-target="#add-sample-modal"
                                      title="Add file(s) to sample"></span>
                                <span class="option-icon remove-sample glyphicon glyphicon-remove" data-toggle="tooltip"
                                      title="Remove sample"></span>
                            </td>
                        </tr>
    
                        <!-- File LISTED -->
                        <tr class="sample-file-row sample-file-template">
                            <td class="file-icon textAlignLeft paddingLeft30"><span class="glyphicon glyphicon-file"></span>
                                <a class="file-name paddingLeft5" data-toggle="modal"></a></td>
                            <td class="file-study-type cell"></td>
                            <td class="file-site-code cell"></td> 
                            <td class="file-time-point cell"></td>                           
                            <td class="file-progress progress cell">
                                <div class="progress-bar progress-bar-striped active" role="progressbar"></div>
                            </td>
                            <td class="file-option option cell">
                                <span class="option-icon remove-file glyphicon glyphicon-remove" data-toggle="tooltip"
                                      title="Remove file"></span>
                            </td>
                        </tr>
                        </tbody>
                </table>
                <div class="panel-footer">
                    <button type="button" class="btn btn-primary col-xs-2 pull-right start-upload disabled"
                            data-toggle="tooltip" title="Upload all files to the DCC">
                        <span class="glyphicon glyphicon-cloud-upload" aria-hidden="true"></span> Upload All
                    </button>
                    <button type="button" class="btn btn-default pull-right cancel-upload"
                            data-toggle="tooltip" title="Cancel upload of all files">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Add sample modal -->
        <div id="add-sample-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Image Metadata</h4>
                    </div>
                    <div class="modal-body">
                        <form class="form-horizontal modal-sample-form">
                            <p>
                                Please specify all applicable metadata for the image you wish to upload. While you may
                                delete the queued images and re-upload, the images already added to the queue cannot be
                                added again.<br><br>
                            </p>

                            <div class="form-group has-error">
                                <label for="add-study-type" class="col-sm-3 control-label">Study</label>
                                <div class="col-sm-9">
                                    <select class="form-control field-study-type dropdown selectpicker" id="add-study-type" multiple>
                                    </select>
                                    <p class="error-description">* Required</p>
                                </div>
                            </div>
                            <div class="form-group has-error">
                                <label for="add-site-code" class="col-sm-3 control-label">Site</label>
                                <div class="col-sm-9">
                                    <select class="form-control field-site-code dropdown" id="add-site-code">
                                        <option selected disabled value="">Please select</option>
                                    </select>
                                    <p class="error-description">* Required</p>                              
                                </div>
                            </div>
                            <div class="form-group has-error">
                                <label for="add-sample-name" class="col-sm-3 control-label">IPSS ID</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control field-sample-name" id="add-sample-name" placeholder="Subject-ID/Patient ID">
                                    <p class="error-description">* Required: may contain letters, numbers, hyphens, or underscores only.</p>
                                </div>
                            </div>
                            <div class="form-group has-error">
                                <label for="add-time-point" class="col-sm-3 control-label">Acute/Follow Up</label>
                                <div class="col-sm-9">
                                    <select class="form-control field-time-point dropdown" id="add-time-point">
                                        <option selected disabled value="">Please select</option>
                                        <option>Acute</option>
                                        <option>Follow-Up</option>
                                    </select>
                                    <p class="error-description">* Required</p>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-11 col-sm-offset-1">
                                    <div class="resumable-droparea">
                                        <span>Drop files here or</span>
                                        <input type="button" class="resumable-browse btn btn-default" value="Browse your computer">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>        
        <!-- Download complete modal -->
        <div id="upload-complete-modal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Upload Complete</h4>
                    </div>
                    <div class="modal-body">
                        <p>Upload completed, any errors are listed below. You may now logout or continue to upload
                            additional samples.
                        </p>
                        <table class="table table-condensed error-table">
                            <thead>
                            <tr>
                                <th>Sample Name</th>
                                <th>File Name</th>
                                <th>Error Description</th>
                            </tr>
                            </thead>
                            <tbody class="error-section">
                            <tr class="file-error-template">
                                <td class="error-sample">sample name placeholder</td>
                                <td class="error-file">file name placeholder</td>
                                <td class="error-msg">error code placeholder</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default logout-button" data-dismiss="modal">
                            <span class="glyphicon glyphicon-log-out"></span> Logout</button>
                        <button type="button" class="btn btn-primary continue-session">Continue</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Table showing the files currently sitting on the DCC -->
        <div class="row col-sm-10 col-sm-offset-1 dcc-table">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <span class="collapse-icon glyphicon glyphicon-triangle-bottom pull-left"></span>
                    <span class="collapse-icon glyphicon glyphicon-triangle-right pull-left" style="display: none;"></span>
                    Previously Uploaded Images
                </div>
                <div class="panel-body">
                    <p>
                        The Images below have been successfully uploaded to the Children's Stroke Program.
                    </p>
                </div>
                <table class="table table-condensed table-data">
                    <thead>
                    <tr class="active">
                        <th class="files header col-sm-4 textAlignLeft paddingLeft20">Files</th>
                        <th class="study-type header col-sm-4">Study Type</th>
                        <th class="site-code header">Site Code</th>
                        <th class="time-point header">Time-Point</th>
                        <th class="progress header"></th>
                        <th class="option header hiddenAway textAlignRight paddingRight20">Options</th>
                    </tr>
                    </thead>
                    <tbody class="sample-template sample-section">
                    <tr class="sample-header-row sample-header-template">
                        <td class="sample-collapse textAlignLeft paddingLeft20">
                            <span class="sample-collapse-icon glyphicon glyphicon-folder-open"></span>
                            <span class="sample-collapse-icon glyphicon glyphicon-folder-close" style="display: none;"></span>
                            <span class="sample-name paddingLeft10"></span>
                        </td>
                        <td class="sample-collapse"></td>
                        <td class="sample-collapse"></td>
                        <td class="sample-collapse"></td>
                        <td class="sample-collapse"></td>
                    </tr>
                    <tr class="sample-file-row sample-file-template">
                        <td class="file-icon textAlignLeft paddingLeft30">
                            <span class="glyphicon glyphicon-file"></span>
                            <span class="file-name" ></span>
                        </td>
                        <td class="file-study-type cell"></td>
                        <td class="file-site-code cell"></td>
                        <td class="file-time-point cell"></td>
                        <td></td>
                    </tr>
                    </tbody>
                </table>
                 <div class="panel-footer"></div>
            </div>
        </div>

        <!-- Footer row -->
        <div class="row col-sm-8 col-sm-offset-4 footer-row">
            <div class="footer">
                <p>Support provided by the <a href="mailto:stroke.research@sickkids.ca">Children's Stroke Program</a></p> 
            </div>
        </div> 
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
            integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
            crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='flow.js') }}"></script>
    <script src="{{ url_for('static', filename='typeahead.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='upload.js') }}"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css">
</body>
</html>